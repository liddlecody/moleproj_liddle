import os
import shutil
import random

# Define paths
data_dir = "processed_images"
train_dir = os.path.join(data_dir, "train")
val_dir = os.path.join(data_dir, "val")

# Create train and val directories
os.makedirs(train_dir, exist_ok=True)
os.makedirs(val_dir, exist_ok=True)

# Define the split ratio
split_ratio = 0.8  # 80% for training, 20% for validation

# Get all image files
all_images = [f for f in os.listdir(data_dir) if f.endswith('.jpg')]

# Shuffle the images randomly
random.shuffle(all_images)

# Split the images
split_index = int(len(all_images) * split_ratio)
train_images = all_images[:split_index]
val_images = all_images[split_index:]

# Move images to the respective directories
for img in train_images:
    shutil.move(os.path.join(data_dir, img), os.path.join(train_dir, img))

for img in val_images:
    shutil.move(os.path.join(data_dir, img), os.path.join(val_dir, img))

print(f"Moved {len(train_images)} images to {train_dir}")
print(f"Moved {len(val_images)} images to {val_dir}")